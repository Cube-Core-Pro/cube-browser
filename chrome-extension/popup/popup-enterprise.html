<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CUBE OmniFill v5.2 Ultimate - Enterprise Universal Autofill</title>
  <link rel="stylesheet" href="popup.css">
  <link rel="stylesheet" href="chat.css">
  <link rel="stylesheet" href="../styles/elite-utilities.css">
  <style>
    /* CUBE OmniFill Enterprise Theme 2.0 */
    :root {
      --primary-blue: #2563eb;
      --primary-dark: #1e40af;
      --primary-light: #3b82f6;
      --accent-green: #10b981;
      --accent-purple: #8b5cf6;
      --gray-50: #f8fafc;
      --gray-100: #f1f5f9;
      --gray-200: #e2e8f0;
      --gray-300: #cbd5e1;
      --gray-400: #94a3b8;
      --gray-500: #64748b;
      --gray-600: #475569;
      --gray-700: #334155;
      --gray-800: #1e293b;
      --gray-900: #0f172a;
    }
    
    /* CRITICAL: Popup Dimensions & Overflow Control */
    html {
      overflow: hidden !important;
    }
    
    html::-webkit-scrollbar {
      display: none !important;
    }
    
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
      background: var(--gray-50);
      color: var(--gray-800);
      width: 600px !important;
      min-width: 600px !important;
      max-width: 600px !important;
      height: 680px !important;
      min-height: 680px !important;
      max-height: 680px !important;
      overflow: hidden !important;
    }
    
    body::-webkit-scrollbar {
      display: none !important;
    }
    
    .container {
      display: flex;
      flex-direction: column;
      width: 100%;
      height: 100%;
      overflow: hidden !important;
      position: relative;
    }
    
    .container::-webkit-scrollbar {
      display: none !important;
    }
    
    /* Premium Header with Gradient */
    .header {
      flex: 0 0 auto;
      background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-dark) 100%);
      color: white;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.15);
    }
    
    .header-row-1 {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .logo svg {
      width: 48px;
      height: 48px;
      filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.1));
    }
    
    .header-text h1 {
      margin: 0;
      font-size: 20px;
      font-weight: 700;
      letter-spacing: -0.5px;
    }
    
    .header-text .subtitle {
      display: block;
      font-size: 12px;
      opacity: 0.9;
      font-weight: 400;
      margin-top: 2px;
    }
    
    .version-badge {
      background: rgba(255, 255, 255, 0.25);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      color: white;
      padding: 4px 12px;
      border-radius: 16px;
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 0.5px;
    }
    
    /* Feature Pills */
    .feature-pills {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      margin-top: 12px;
    }
    
    .feature-pill {
      background: rgba(255, 255, 255, 0.2);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.25);
      color: white;
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 10px;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    .feature-pill svg {
      width: 12px;
      height: 12px;
    }
    
    /* Connection Status with Animation */
    .connection-status {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      padding: 6px 12px;
      background: rgba(255, 255, 255, 0.15);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      color: white;
    }
    
    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.6);
    }
    
    .status-dot.active {
      background: #10b981;
      animation: pulse 2s ease-in-out infinite;
      box-shadow: 0 0 8px rgba(16, 185, 129, 0.6);
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.7; transform: scale(1.1); }
    }
    
    /* Tabs with Modern Design - 6 tabs Enterprise */
    .tabs {
      display: flex;
      background: white;
      border-bottom: 2px solid var(--gray-200);
      padding: 0;
      gap: 0;
      flex-shrink: 0;
    }
    
    .tab {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 4px;
      padding: 12px 4px;
      border: none;
      background: transparent;
      color: var(--gray-600);
      font-size: 11px;
      font-weight: 600;
      cursor: pointer;
      border-bottom: 3px solid transparent;
      transition: all 0.2s ease;
      position: relative;
      white-space: nowrap;
    }
    
    .tab:hover {
      color: var(--primary-blue);
      background: var(--gray-50);
    }
    
    .tab.active {
      color: var(--primary-blue);
      border-bottom-color: var(--primary-blue);
      background: var(--gray-50);
      font-weight: 700;
    }
    
    .tab svg {
      width: 14px;
      height: 14px;
      flex-shrink: 0;
    }
    
    /* Content Area - Wrapper WITHOUT scroll */
    .content {
      flex: 1 1 auto;
      overflow: hidden !important;
      background: var(--gray-50);
      min-height: 0;
      position: relative;
      display: flex !important;
      flex-direction: column !important;
      box-shadow: none !important;
      border: none !important;
    }
    
    .content::-webkit-scrollbar {
      display: none !important;
    }
    
    /* Tab Content - These WILL scroll */
    .tab-content {
      display: none;
      padding: 20px;
      padding-bottom: 30px;
      overflow-y: auto !important;
      overflow-x: hidden !important;
      flex: 1 1 auto;
      min-height: 0;
    }
    
    .tab-content.active {
      display: block;
      overflow-y: auto !important;
      overflow-x: hidden !important;
    }
    
    /* Custom Scrollbar for tab-content - Minimal Design */
    .tab-content::-webkit-scrollbar {
      width: 6px !important;
    }
    
    .tab-content::-webkit-scrollbar-track {
      background: transparent !important;
    }
    
    .tab-content::-webkit-scrollbar-thumb {
      background: var(--gray-400);
      border-radius: 3px;
    }
    
    .tab-content::-webkit-scrollbar-thumb:hover {
      background: var(--gray-500);
    }
    
    /* Fix Chat AI - Remove Double Scroll */
    .ai-chat-container {
      height: auto !important;
      overflow: visible !important;
    }
    
    .chat-messages {
      overflow-y: visible !important;
      overflow-x: hidden !important;
      max-height: none !important;
      /* min-height: auto - not supported in Firefox, using 0 instead */
      min-height: 0 !important;
    }
    
    .chat-messages::-webkit-scrollbar {
      display: none !important;
    }
    
    .chat-input {
      overflow-y: auto !important;
      max-height: 80px !important;
    }
    
    .chat-input-container {
      position: relative;
      margin-top: 16px;
    }
    
    /* Panel Headers */
    .panel-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }
    
    .panel-header h2 {
      margin: 0;
      font-size: 18px;
      font-weight: 700;
      color: var(--gray-800);
    }
    
    /* Stats Bar with Cards */
    .stats-bar {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin: 16px 0;
    }
    
    .stat {
      background: white;
      padding: 16px;
      border-radius: 12px;
      border: 1px solid var(--gray-200);
      text-align: center;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    }
    
    .stat-label {
      display: block;
      font-size: 11px;
      font-weight: 600;
      color: var(--gray-500);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 8px;
    }
    
    .stat-value {
      display: block;
      font-size: 24px;
      font-weight: 700;
      color: var(--primary-blue);
    }
    
    /* CRM Integration Status */
    .crm-status {
      background: white;
      border-radius: 12px;
      border: 1px solid var(--gray-200);
      padding: 16px;
      margin: 16px 0;
    }
    
    .crm-status-header {
      font-size: 13px;
      font-weight: 600;
      color: var(--gray-700);
      margin-bottom: 12px;
    }
    
    .crm-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .crm-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 12px;
      background: var(--gray-50);
      border-radius: 8px;
      border: 1px solid var(--gray-200);
    }
    
    .crm-info {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .crm-icon {
      width: 24px;
      height: 24px;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      font-weight: 700;
    }
    
    .crm-name {
      font-size: 13px;
      font-weight: 600;
      color: var(--gray-700);
    }
    
    .crm-status-badge {
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .crm-status-badge.connected {
      background: #d1fae5;
      color: #065f46;
    }
    
    .crm-status-badge.disconnected {
      background: #fef3c7;
      color: #92400e;
    }
    
    /* Buttons with Premium Look */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px 20px;
      border: none;
      border-radius: 10px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
    }
    
    .btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
    }
    
    .btn:active {
      transform: translateY(0);
    }
    
    .btn-primary {
      background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-dark) 100%);
      color: white;
    }
    
    .btn-success {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white;
    }
    
    .btn-success:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
    
    .btn-secondary {
      background: white;
      color: var(--gray-700);
      border: 1px solid var(--gray-300);
    }
    
    .btn-danger {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
      color: white;
    }
    
    .btn svg {
      width: 18px;
      height: 18px;
    }
    
    .btn.loading {
      position: relative;
      color: transparent;
      pointer-events: none;
    }
    
    .btn.loading::after {
      content: '';
      position: absolute;
      width: 16px;
      height: 16px;
      top: 50%;
      left: 50%;
      margin-left: -8px;
      margin-top: -8px;
      border: 2px solid white;
      border-radius: 50%;
      border-top-color: transparent;
      animation: spinner 0.6s linear infinite;
    }
    
    @keyframes spinner {
      to { transform: rotate(360deg); }
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Actions Grid */
    .actions {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin: 16px 0;
    }
    
    /* Voice Control Panel */
    .voice-control {
      background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
      border-radius: 12px;
      padding: 16px;
      margin: 16px 0;
      color: white;
      box-shadow: 0 4px 12px rgba(139, 92, 246, 0.2);
    }
    
    .voice-control-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
    }
    
    .voice-control-title {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      font-weight: 600;
    }
    
    .voice-status {
      padding: 4px 10px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
    }
    
    .voice-status.listening {
      background: #10b981;
      animation: pulse 1.5s ease-in-out infinite;
    }
    
    .voice-actions {
      display: flex;
      gap: 8px;
    }
    
    .voice-btn {
      flex: 1;
      padding: 10px;
      background: rgba(255, 255, 255, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 8px;
      color: white;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .voice-btn:hover {
      background: rgba(255, 255, 255, 0.3);
    }
    
    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: var(--gray-500);
    }
    
    .empty-state svg {
      margin-bottom: 16px;
      width: 48px !important;
      height: 48px !important;
      max-width: 48px !important;
      max-height: 48px !important;
    }
    
    .empty-state p {
      margin: 8px 0;
      font-size: 14px;
      font-weight: 600;
    }
    
    .empty-state small {
      font-size: 12px;
      color: var(--gray-400);
    }
    
    /* Status Bar */
    .status-bar {
      flex: 0 0 auto;
      display: flex;
      align-items: center;
      padding: 8px 20px;
      background: white;
      border-top: 1px solid var(--gray-200);
      font-size: 11px;
      color: var(--gray-600);
    }
    
    #status-message {
      flex: 1;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    /* Footer */
    footer {
      flex: 0 0 auto;
      padding: 8px 20px;
      background: var(--gray-50);
      border-top: 1px solid var(--gray-200);
      text-align: center;
      font-size: 9px;
      color: var(--gray-500);
      line-height: 1.4;
    }
    
    footer a {
      color: var(--primary-blue);
      text-decoration: none;
      margin: 0 8px;
    }
    
    footer a:hover {
      text-decoration: underline;
    }

    /* Utility Classes */
    .mt-12 { margin-top: 12px; }
    .mb-6 { margin-bottom: 6px; }
    .mb-12 { margin-bottom: 12px; }
    .hidden { display: none; }
    
    /* Page Info Card */
    .page-info-card {
      background: white;
      border-radius: 12px;
      border: 1px solid var(--gray-200);
      padding: 12px 16px;
      margin-bottom: 16px;
    }
    
    .page-info-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 6px;
    }
    
    .page-info-icon { color: var(--primary-blue); }
    .page-info-label { font-size: 12px; font-weight: 600; color: var(--gray-700); }
    .page-url { font-size: 11px; color: var(--gray-500); word-break: break-all; line-height: 1.4; }
    .page-title { font-size: 12px; color: var(--gray-600); margin-top: 4px; font-weight: 500; }
    
    /* CRM Icons */
    .crm-icon-sf { background: #00A1E0; color: white; }
    .crm-icon-hs { background: #FF7A59; color: white; }
    .crm-icon-d365 { background: #00A4EF; color: white; }
    
    /* Button Rows */
    .btn-row { display: flex; gap: 8px; }
    .btn-sm { padding: 8px 16px; font-size: 12px; }
    .btn-full { width: 100%; }
    
    /* SVG Margin */
    .svg-mr-4 { margin-right: 4px; }
    
    /* Section Cards */
    .section-card {
      background: white;
      border-radius: 12px;
      border: 1px solid var(--gray-200);
      padding: 16px;
      margin-bottom: 16px;
    }
    
    .section-header {
      font-weight: 600;
      font-size: 14px;
      color: var(--gray-800);
      margin-bottom: 12px;
    }
    
    .section-header-flex {
      font-weight: 600;
      font-size: 14px;
      color: var(--gray-800);
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    /* Filter Grid */
    .filter-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
      font-size: 12px;
    }
    
    .filter-label {
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
    }
    
    .filter-label-bold { font-weight: 600; }
    
    /* Figure Upload Section */
    .figure-section {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
      color: white;
    }
    
    .figure-section-header {
      font-weight: 600;
      font-size: 14px;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .figure-section-text {
      font-size: 12px;
      opacity: 0.9;
      margin: 0 0 12px 0;
    }
    
    .figure-btn {
      width: 100%;
      background: rgba(255,255,255,0.2);
      border: 1px solid rgba(255,255,255,0.3);
      color: white;
    }
    
    .figure-status {
      margin-top: 12px;
      padding: 10px;
      background: rgba(255,255,255,0.15);
      border-radius: 8px;
      font-size: 12px;
    }
    
    /* Reload Button */
    .reload-btn-styled {
      margin-left: 8px;
      padding: 4px 10px;
      background: rgba(255,255,255,0.2);
      border: 1px solid rgba(255,255,255,0.3);
      border-radius: 6px;
      font-size: 10px;
      cursor: pointer;
    }
    
    /* OCR Section */
    .ocr-row {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
    }
    
    .ocr-select {
      flex: 1;
      padding: 8px;
      border: 1px solid var(--gray-300);
      border-radius: 6px;
      font-size: 13px;
    }

    /* ===== UTILITY CLASSES ===== */
    
    /* Display */
    .hidden { display: none !important; }
    .flex { display: flex; }
    .flex-col { flex-direction: column; }
    .flex-1 { flex: 1; }
    .flex-2 { flex: 2; }
    .grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); }
    
    /* Alignment */
    .items-center { align-items: center; }
    .justify-center { justify-content: center; }
    .justify-between { justify-content: space-between; }
    
    /* Spacing */
    .gap-4 { gap: 4px; }
    .gap-6 { gap: 6px; }
    .gap-8 { gap: 8px; }
    .gap-10 { gap: 10px; }
    .gap-12 { gap: 12px; }
    .gap-16 { gap: 16px; }
    .mb-6 { margin-bottom: 6px; }
    .mb-12 { margin-bottom: 12px; }
    .mb-16 { margin-bottom: 16px; }
    .mt-4 { margin-top: 4px; }
    .mt-12 { margin-top: 12px; }
    .mr-4 { margin-right: 4px; }
    .p-8 { padding: 8px; }
    .p-10 { padding: 10px; }
    .p-12 { padding: 12px; }
    .p-16 { padding: 16px; }
    .px-12 { padding-left: 12px; padding-right: 12px; }
    .py-8 { padding-top: 8px; padding-bottom: 8px; }
    
    /* Width & Height */
    .w-full { width: 100%; }
    .w-40 { width: 40px; }
    .h-40 { height: 40px; }
    
    /* Typography */
    .text-11 { font-size: 11px; }
    .text-12 { font-size: 12px; }
    .text-13 { font-size: 13px; }
    .text-14 { font-size: 14px; }
    .font-bold { font-weight: 600; }
    .font-500 { font-weight: 500; }
    .opacity-90 { opacity: 0.9; }
    
    /* Colors */
    .text-primary-blue { color: var(--primary-blue); }
    .text-gray-500 { color: var(--gray-500); }
    .text-gray-600 { color: var(--gray-600); }
    .text-gray-700 { color: var(--gray-700); }
    .text-gray-800 { color: var(--gray-800); }
    .text-white { color: white; }
    .bg-white { background: white; }
    .bg-gray-50 { background: var(--gray-50); }
    
    /* Card styles */
    .card-white {
      background: white;
      border-radius: 12px;
      border: 1px solid var(--gray-200);
      padding: 16px;
      margin-bottom: 16px;
    }
    
    .card-white-compact {
      background: white;
      border-radius: 12px;
      border: 1px solid var(--gray-200);
      padding: 12px 16px;
      margin-bottom: 16px;
    }
    
    .card-white-last {
      background: white;
      border-radius: 12px;
      border: 1px solid var(--gray-200);
      padding: 16px;
    }
    
    /* Page info */
    .page-info-row { display: flex; align-items: center; gap: 10px; margin-bottom: 6px; }
    .page-url { font-size: 11px; color: var(--gray-500); word-break: break-all; line-height: 1.4; }
    .page-title { font-size: 12px; color: var(--gray-600); margin-top: 4px; font-weight: 500; }
    .page-label { font-size: 12px; font-weight: 600; color: var(--gray-700); }
    
    /* CRM icons */
    .crm-icon-sf { background: #00A1E0; color: white; }
    .crm-icon-hs { background: #FF7A59; color: white; }
    .crm-icon-d365 { background: #00A4EF; color: white; }
    .crm-icon-dynamics { background: #002050; color: white; }
    
    /* CRM Card Header */
    .crm-card-header { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
    .crm-card-icon {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .crm-card-title { font-weight: 600; font-size: 14px; color: var(--gray-800); }
    .crm-card-subtitle { font-size: 11px; color: var(--gray-500); }
    
    /* Button sizes */
    .btn-sm { padding: 6px 12px; font-size: 12px; }
    .btn-md { padding: 8px 16px; font-size: 12px; }
    .btn-lg { padding: 8px 16px; font-size: 13px; }
    
    /* SVG margin */
    .svg-mr { margin-right: 4px; }
    
    /* Form inputs */
    .input-styled {
      padding: 8px 12px;
      border: 1px solid var(--gray-300);
      border-radius: 6px;
      font-size: 13px;
    }
    
    .select-styled {
      padding: 8px 12px;
      border: 1px solid var(--gray-300);
      border-radius: 8px;
      font-size: 13px;
      background: white;
    }
    
    .select-lg {
      width: 100%;
      padding: 10px;
      border: 1px solid var(--gray-300);
      border-radius: 8px;
      font-size: 13px;
      margin-bottom: 12px;
    }
    
    /* Form labels */
    .form-label {
      display: flex;
      flex-direction: column;
      gap: 6px;
      font-size: 13px;
      color: var(--gray-700);
    }
    
    .checkbox-label {
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
    }
    
    .checkbox-label-between {
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 13px;
      color: var(--gray-700);
    }
    
    .checkbox-styled {
      width: 18px;
      height: 18px;
      cursor: pointer;
    }
    
    /* Filter section */
    .filter-section {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
      font-size: 12px;
    }
    
    /* Gradient sections */
    .figure-upload-section {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
      color: white;
    }
    
    .figure-upload-header {
      font-weight: 600;
      font-size: 14px;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .figure-upload-text {
      font-size: 12px;
      opacity: 0.9;
      margin: 0 0 12px 0;
    }
    
    .figure-upload-btn {
      width: 100%;
      background: rgba(255,255,255,0.2);
      border: 1px solid rgba(255,255,255,0.3);
      color: white;
    }
    
    .figure-upload-status {
      margin-top: 12px;
      padding: 10px;
      background: rgba(255,255,255,0.15);
      border-radius: 8px;
      font-size: 12px;
    }
    
    /* Autofill results */
    .autofill-results {
      margin-top: 12px;
      padding: 10px;
      background: var(--gray-50);
      border-radius: 8px;
      font-size: 12px;
    }
    
    /* History */
    .history-filters { display: flex; gap: 8px; margin-bottom: 16px; }
    .history-list { display: flex; flex-direction: column; gap: 12px; }
    .history-actions { display: flex; gap: 8px; }
    
    /* Settings form */
    .settings-form { display: flex; flex-direction: column; gap: 10px; }
    
    /* Range input */
    .range-styled {
      width: 100%;
      cursor: pointer;
    }
    
    /* Monospace input */
    .input-mono {
      font-family: monospace;
    }
    
    /* Text utilities */
    .text-small {
      color: var(--gray-500);
      font-size: 11px;
    }
    
    .text-link {
      color: var(--primary-blue);
      text-decoration: none;
    }
    
    .text-link:hover {
      text-decoration: underline;
    }
    
    .text-error {
      color: #ef4444;
    }
    
    .font-semibold {
      font-weight: 600;
    }
    
    /* Button full width */
    .btn-full {
      width: 100%;
    }
    
    /* Figure upload description */
    .figure-upload-description {
      font-size: 12px;
      opacity: 0.9;
      margin: 0 0 12px 0;
    }
    
    /* Section header */
    .section-header {
      font-weight: 600;
      font-size: 14px;
      color: var(--gray-800);
      margin-bottom: 12px;
    }
    
    .flex-row {
      display: flex;
      align-items: center;
    }
    
    /* About content */
    .about-content {
      font-size: 12px;
      color: var(--gray-600);
      line-height: 1.6;
    }
    
    .about-content p {
      margin: 0 0 8px 0;
    }
    
    .about-content p.no-margin {
      margin: 0;
    }
    
    /* Text success */
    .text-success {
      color: var(--accent-green);
    }
    
    /* API test result */
    .api-test-result {
      padding: 10px;
      border-radius: 8px;
      font-size: 12px;
      margin-top: 4px;
    }
    
    /* Footer */
    .footer-links {
      margin-bottom: 6px;
    }
    
    .footer-dot {
      color: var(--gray-300);
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Premium Header -->
    <header class="header">
      <div class="header-row-1">
        <div class="logo">
          <svg width="48" height="48" viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <linearGradient id="cubeGrad1" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#60a5fa" stop-opacity="1" />
                <stop offset="100%" stop-color="#3b82f6" stop-opacity="1" />
              </linearGradient>
              <linearGradient id="cubeGrad2" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#93c5fd" stop-opacity="1" />
                <stop offset="100%" stop-color="#60a5fa" stop-opacity="1" />
              </linearGradient>
              <linearGradient id="cubeGrad3" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#dbeafe" stop-opacity="1" />
                <stop offset="100%" stop-color="#93c5fd" stop-opacity="1" />
              </linearGradient>
              <linearGradient id="checkGreen" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#34d399" stop-opacity="1" />
                <stop offset="100%" stop-color="#10b981" stop-opacity="1" />
              </linearGradient>
            </defs>
            <g transform="translate(64, 50)">
              <!-- Top face -->
              <path d="M 0,-20 L 28,-10 L 0,0 L -28,-10 Z" fill="url(#cubeGrad3)" stroke="white" stroke-width="1.5" opacity="0.9"/>
              <!-- Left face -->
              <path d="M -28,-10 L -28,25 L 0,35 L 0,0 Z" fill="url(#cubeGrad2)" stroke="white" stroke-width="1.5" opacity="0.95"/>
              <!-- Right face -->
              <path d="M 0,0 L 0,35 L 28,25 L 28,-10 Z" fill="url(#cubeGrad1)" stroke="white" stroke-width="1.5"/>
              <!-- Glow effect -->
              <circle cx="0" cy="8" r="18" fill="url(#checkGreen)" opacity="0.15"/>
              <!-- Check mark -->
              <g transform="translate(0, 12)">
                <circle cx="0" cy="0" r="10" fill="url(#checkGreen)"/>
                <path d="M -3.5,0 L -1.5,3 L 4.5,-4" stroke="white" stroke-width="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
              </g>
            </g>
          </svg>
          <div class="header-text">
            <h1>CUBE OmniFill</h1>
            <span class="subtitle">Enterprise Universal Autofill</span>
          </div>
        </div>
        <div class="version-badge">v5.2 Ultimate</div>
      </div>
      <div class="feature-pills">
        <div class="feature-pill">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/></svg>
          Voice Control
        </div>
        <div class="feature-pill">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
          AI-Powered
        </div>
        <div class="feature-pill">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 3v9.28c-.47-.17-.97-.28-1.5-.28C8.01 12 6 14.01 6 16.5S8.01 21 10.5 21c2.31 0 4.2-1.75 4.45-4H15V6h4V3h-7z"/></svg>
          Sound Feedback
        </div>
        <div class="feature-pill">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V8l8 5 8-5v10zm-8-7L4 6h16l-8 5z"/></svg>
          CRM Sync
        </div>
      </div>
      <div class="connection-status mt-12" id="connection-status">
        <span class="status-dot" id="status-dot"></span>
        <span id="status-text">Initializing...</span>
        <button id="reload-content-script" class="reload-btn reload-btn-styled hidden">
          Reload
        </button>
      </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="tabs">
      <button class="tab active" data-tab="dashboard">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/></svg>
        <span>Dashboard</span>
      </button>
      <button class="tab" data-tab="pdfs">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6z"/></svg>
        <span>Documents</span>
      </button>
      <button class="tab" data-tab="autofill">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
        <span>AutoFill</span>
      </button>
      <button class="tab" data-tab="history">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"/></svg>
        <span>History</span>
      </button>
      <button class="tab" data-tab="integrations">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
        <span>CRM</span>
      </button>
      <button class="tab" data-tab="settings">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/></svg>
        <span>Settings</span>
      </button>
      <button class="tab" data-tab="chat">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"/><circle cx="12" cy="10" r="1.5"/><circle cx="8" cy="10" r="1.5"/><circle cx="16" cy="10" r="1.5"/></svg>
        <span>AI Chat</span>
      </button>
    </nav>

    <!-- Content Area -->
    <div class="content">
      
      <!-- Dashboard Panel -->
      <div id="dashboard-panel" class="tab-content active">
        <div class="panel-header">
          <h2>Dashboard</h2>
        </div>

        <!-- Current Page Info -->
        <div id="current-page-info" class="card-white-compact hidden">
          <div class="page-info-row">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="text-primary-blue">
              <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
            </svg>
            <span class="page-label">Current Page</span>
          </div>
          <div id="page-url" class="page-url"></div>
          <div id="page-title" class="page-title"></div>
        </div>

        <!-- Stats Cards -->
        <div class="stats-bar">
          <div class="stat">
            <span class="stat-label">Documents</span>
            <span id="total-pdfs" class="stat-value">0</span>
          </div>
          <div class="stat">
            <span class="stat-label">Filled</span>
            <span id="filled-fields" class="stat-value">0</span>
          </div>
          <div class="stat">
            <span class="stat-label">Accuracy</span>
            <span id="accuracy-rate" class="stat-value">0%</span>
          </div>
        </div>

        <!-- Voice Control Panel -->
        <div class="voice-control">
          <div class="voice-control-header">
            <div class="voice-control-title">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
                <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
              </svg>
              Voice Control
            </div>
            <div class="voice-status" id="voice-status">Ready</div>
          </div>
          <div class="voice-actions">
            <button class="voice-btn" id="voice-start">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
              </svg>
              Start Listening
            </button>
            <button class="voice-btn hidden" id="voice-stop">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M6 6h12v12H6z"/>
              </svg>
              Stop
            </button>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="actions">
          <button id="detect-pdfs" class="btn btn-primary">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
            </svg>
            <span>Detect Docs</span>
          </button>
          <button id="run-autofill" class="btn btn-success">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/>
            </svg>
            <span>Auto-Fill</span>
          </button>
        </div>

        <!-- CRM Integration Status -->
        <div class="crm-status">
          <div class="crm-status-header">CRM Integrations</div>
          <div class="crm-list">
            <div class="crm-item">
              <div class="crm-info">
                <div class="crm-icon crm-icon-sf">SF</div>
                <div class="crm-name">Salesforce</div>
              </div>
              <div class="crm-status-badge disconnected">Not Connected</div>
            </div>
            <div class="crm-item">
              <div class="crm-info">
                <div class="crm-icon crm-icon-hs">HS</div>
                <div class="crm-name">HubSpot</div>
              </div>
              <div class="crm-status-badge disconnected">Not Connected</div>
            </div>
            <div class="crm-item">
              <div class="crm-info">
                <div class="crm-icon crm-icon-d365">D365</div>
                <div class="crm-name">Dynamics 365</div>
              </div>
              <div class="crm-status-badge disconnected">Not Connected</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Documents Panel -->
      <div id="pdfs-panel" class="tab-content">
        <div class="panel-header">
          <h2>Document Management</h2>
          <div class="flex gap-8">
            <button id="parse-all-pdfs" class="btn btn-primary btn-md hidden">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" class="svg-mr">
                <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm4 18H6V4h7v5h5v11zM8 15.01l1.41 1.41L11 14.84V19h2v-4.16l1.59 1.59L16 15.01 12.01 11z"/>
              </svg>
              Parse All
            </button>
            <button id="download-all-pdfs" class="btn btn-accent btn-md hidden">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" class="svg-mr">
                <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
              </svg>
              Download All
            </button>
            <button id="refresh-pdfs" class="btn btn-secondary btn-md">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
              </svg>
            </button>
          </div>
        </div>

        <!-- Document Format Selection -->
        <div class="card-white">
          <div class="section-header">
            ðŸ“„ Detection Formats
          </div>
          <div class="filter-section">
            <label class="checkbox-label">
              <input type="checkbox" id="format-pdf" class="format-checkbox" value="pdf" checked>
              <span>PDF Documents</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="format-excel" class="format-checkbox" value="xlsx" checked>
              <span>Excel (XLS/XLSX)</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="format-word" class="format-checkbox" value="docx" checked>
              <span>Word (DOC/DOCX)</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="format-ppt" class="format-checkbox" value="pptx">
              <span>PowerPoint (PPT/PPTX)</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="format-images" class="format-checkbox" value="images">
              <span>Images (JPG/PNG)</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="format-csv" class="format-checkbox" value="csv">
              <span>CSV Files</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="format-txt" class="format-checkbox" value="txt">
              <span>Text Files</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="format-all" class="format-checkbox" value="all">
              <span class="font-semibold">All Formats</span>
            </label>
          </div>
        </div>

        <div id="pdf-list" class="pdf-list">
          <div class="empty-state">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor" opacity="0.3">
              <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6z"/>
            </svg>
            <p>No documents detected</p>
            <small>Select formats above and click Refresh</small>
          </div>
        </div>
      </div>

      <!-- AutoFill Panel -->
      <div id="autofill-panel" class="tab-content">
        <div class="panel-header">
          <h2>Intelligent AutoFill</h2>
        </div>

        <!-- Form Detection Section -->
        <div class="card-white">
          <div class="section-header flex-row gap-8">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
            </svg>
            Detect Forms on Page
          </div>
          
          <button id="detect-forms" class="btn btn-primary btn-full mb-12">
            <svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18">
              <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
            </svg>
            Detect Forms
          </button>
          
          <div id="detected-forms-list" class="hidden">
            <!-- Forms will be populated here -->
          </div>
        </div>

        <!-- LendingPad FIGURE Section -->
        <div class="figure-upload-section">
          <div class="figure-upload-header">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
            </svg>
            LendingPad FIGURE Compensation
          </div>
          <p class="figure-upload-description">
            Upload FIGURE ZIP bundle to auto-fill LendingPad loan application
          </p>
          
          <input 
            type="file" 
            id="figure-zip-upload" 
            accept=".zip" 
            class="hidden"
          />
          
          <button id="upload-figure-zip" class="figure-upload-btn">
            <svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18">
              <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
            </svg>
            Upload FIGURE ZIP
          </button>
          
          <div id="figure-upload-status" class="figure-upload-status hidden">
            <!-- Status will appear here -->
          </div>
        </div>

        <!-- OCR Section -->
        <div class="card-white">
          <div class="section-header flex-row gap-8">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
            </svg>
            OCR - Extract Text from Images
          </div>
          
          <div class="ocr-row">
            <select id="ocr-language" class="ocr-select">
              <option value="eng">English</option>
              <option value="spa">EspaÃ±ol</option>
              <option value="fra">FranÃ§ais</option>
            </select>
            
            <button id="run-ocr-page" class="btn btn-primary flex-2">
              <svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18">
                <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
              </svg>
              Extract from Page
            </button>
          </div>
          
          <div id="ocr-results" class="hidden">
            <!-- OCR results will appear here -->
          </div>
        </div>

        <!-- Form Type Selector -->
        <div class="card-white-last">
          <div class="section-header flex-row gap-8">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
            </svg>
            Select Form Type
          </div>
          
          <select id="form-type-selector" class="select-lg">
            <optgroup label="ðŸ¤– Smart Auto-Select">
              <option value="auto-detect" selected>Auto-Detect Form Type</option>
            </optgroup>
            
            <optgroup label="ðŸ¦ Financial & Banking">
              <option value="loan-application">Loan Application (Full)</option>
              <option value="loan-personal">Personal Loan</option>
              <option value="loan-mortgage">Mortgage Application</option>
              <option value="credit-card">Credit Card Application</option>
              <option value="bank-account">Bank Account Opening</option>
            </optgroup>
            
            <optgroup label="ðŸ’¼ Employment">
              <option value="job-application">Job Application</option>
              <option value="w9-tax">W-9 Tax Form</option>
              <option value="i9-employment">I-9 Employment</option>
            </optgroup>
            
            <optgroup label="ðŸ¥ Healthcare">
              <option value="health-insurance">Health Insurance</option>
              <option value="medical-history">Medical History</option>
            </optgroup>
            
            <optgroup label="ðŸŽ“ Education">
              <option value="college-admission">College Admission</option>
              <option value="fafsa">FAFSA</option>
              <option value="scholarship">Scholarship</option>
            </optgroup>
            
            <optgroup label="ðŸ  Real Estate">
              <option value="rental-app">Rental Application</option>
              <option value="property-purchase">Property Purchase</option>
            </optgroup>
            
            <optgroup label="ðŸš— Automotive">
              <option value="auto-insurance">Auto Insurance</option>
              <option value="dmv-registration">DMV Registration</option>
            </optgroup>
            
            <optgroup label="ðŸ“‹ Government">
              <option value="tax-return">Tax Return (1040)</option>
              <option value="passport-app">Passport Application</option>
              <option value="voter-registration">Voter Registration</option>
            </optgroup>
          </select>
          
          <button id="run-intelligent-autofill" class="btn btn-success btn-full">
            <svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18">
              <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
            </svg>
            Run Intelligent AutoFill
          </button>
          
          <div id="autofill-results" class="autofill-results hidden">
            <!-- Results will appear here -->
          </div>
        </div>
      </div>

      <!-- CRM Integrations Panel -->
      <div id="integrations-panel" class="tab-content">
        <div class="panel-header">
          <h2>CRM Integrations</h2>
        </div>

        <!-- Salesforce -->
        <div class="card-white">
          <div class="crm-card-header">
            <div class="crm-card-icon crm-icon-sf">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"/>
              </svg>
            </div>
            <div class="flex-1">
              <div class="crm-card-title">Salesforce</div>
              <div class="crm-card-subtitle">OAuth 2.0 â€¢ REST API</div>
            </div>
            <span id="salesforce-badge" class="crm-status-badge disconnected">Not Connected</span>
          </div>
          
          <div class="flex-col gap-10">
            <label class="form-label">
              <span>Instance URL</span>
              <input type="text" id="salesforce-url" placeholder="https://yourcompany.salesforce.com" class="input-styled">
            </label>
            <label class="form-label">
              <span>API Token</span>
              <input type="password" id="salesforce-token" placeholder="Enter your API token" class="input-styled">
            </label>
            <button id="connect-salesforce" class="btn btn-primary btn-lg">
              Connect Salesforce
            </button>
          </div>
        </div>

        <!-- HubSpot -->
        <div class="card-white">
          <div class="crm-card-header">
            <div class="crm-card-icon crm-icon-hs">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"/>
              </svg>
            </div>
            <div class="flex-1">
              <div class="crm-card-title">HubSpot</div>
              <div class="crm-card-subtitle">OAuth 2.0 â€¢ REST API</div>
            </div>
            <span id="hubspot-badge" class="crm-status-badge disconnected">Not Connected</span>
          </div>
          
          <div class="flex-col gap-10">
            <label class="form-label">
              <span>API Key</span>
              <input type="password" id="hubspot-key" placeholder="Enter your HubSpot API key" class="input-styled">
            </label>
            <button id="connect-hubspot" class="btn btn-primary btn-lg">
              Connect HubSpot
            </button>
          </div>
        </div>

        <!-- Dynamics 365 -->
        <div class="card-white-last">
          <div class="crm-card-header">
            <div class="crm-card-icon crm-icon-dynamics">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"/>
              </svg>
            </div>
            <div class="flex-1">
              <div class="crm-card-title">Dynamics 365</div>
              <div class="crm-card-subtitle">OAuth 2.0 â€¢ OData API</div>
            </div>
            <span id="dynamics-badge" class="crm-status-badge disconnected">Not Connected</span>
          </div>
          
          <div class="flex-col gap-10">
            <label class="form-label">
              <span>Organization URL</span>
              <input type="text" id="dynamics-url" placeholder="https://yourorg.crm.dynamics.com" class="input-styled">
            </label>
            <label class="form-label">
              <span>Client ID</span>
              <input type="text" id="dynamics-client-id" placeholder="Enter your Client ID" class="input-styled">
            </label>
            <label class="form-label">
              <span>Client Secret</span>
              <input type="password" id="dynamics-secret" placeholder="Enter your Client Secret" class="input-styled">
            </label>
            <button id="connect-dynamics" class="btn btn-primary btn-lg">
              Connect Dynamics 365
            </button>
          </div>
        </div>
      </div>

      <!-- History Panel -->
      <div id="history-panel" class="tab-content">
        <div class="panel-header">
          <h2>Activity History</h2>
          <div class="flex gap-8">
            <button id="export-history" class="btn btn-secondary btn-sm">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" class="svg-mr">
                <path d="M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"/>
              </svg>
              Export
            </button>
            <button id="clear-history" class="btn btn-secondary btn-sm">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" class="svg-mr">
                <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
              </svg>
              Clear
            </button>
          </div>
        </div>

        <!-- History Filter -->
        <div class="flex gap-8 mb-16">
          <select id="history-filter" class="select-styled flex-1">
            <option value="all">All Activities</option>
            <option value="parse">Parse Only</option>
            <option value="fill">Fill Only</option>
            <option value="export">Exports</option>
          </select>
          <select id="history-period" class="select-styled">
            <option value="today">Today</option>
            <option value="week">This Week</option>
            <option value="month">This Month</option>
            <option value="all">All Time</option>
          </select>
        </div>

        <!-- History List -->
        <div id="history-list" class="flex-col gap-12">
          <!-- History items will be populated here -->
          <div class="empty-state">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor" opacity="0.3">
              <path d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"/>
            </svg>
            <p>No activity yet</p>
            <small>Parse or fill documents to see history</small>
          </div>
        </div>
      </div>

      <!-- Settings Panel -->
      <div id="settings-panel" class="tab-content">
        <div class="panel-header">
          <h2>Settings</h2>
        </div>

        <!-- Settings Sections -->
        <div class="flex-col gap-16">
          
          <!-- Voice Settings -->
          <div class="card-white">
            <div class="section-header flex-row gap-8">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
              </svg>
              Voice Control
            </div>
            <div class="flex-col gap-10">
              <label class="checkbox-label-between">
                <span>Enable Voice Commands</span>
                <input type="checkbox" checked class="checkbox-styled">
              </label>
              <label class="form-label">
                <span>Voice Language</span>
                <select class="select-styled">
                  <option>English (US)</option>
                  <option>English (UK)</option>
                  <option>Spanish</option>
                  <option>French</option>
                  <option>German</option>
                </select>
              </label>
            </div>
          </div>

          <!-- Sound Settings -->
          <div class="card-white">
            <div class="section-header flex-row gap-8">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z"/>
              </svg>
              Sound Feedback
            </div>
            <div class="flex-col gap-10">
              <label class="checkbox-label-between">
                <span>Enable Sound Effects</span>
                <input type="checkbox" checked class="checkbox-styled">
              </label>
              <label class="form-label">
                <span>Volume</span>
                <input type="range" min="0" max="100" value="75" class="range-styled">
              </label>
            </div>
          </div>

          <!-- AI Settings -->
          <div class="card-white">
            <div class="section-header flex-row gap-8">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
              </svg>
              AI Configuration - OpenAI
            </div>
            <div class="flex-col gap-12">
              <label class="form-label">
                <span class="font-semibold">OpenAI API Key <span class="text-error">*</span></span>
                <input 
                  type="password" 
                  id="openai-api-key" 
                  placeholder="sk-proj-..." 
                  class="input-styled input-mono"
                />
                <small class="text-small">
                  Get your API key from <a href="https://platform.openai.com/api-keys" target="_blank" rel="noopener" class="text-link">platform.openai.com/api-keys</a>
                </small>
              </label>
              
              <label class="form-label">
                <span class="font-semibold">OpenAI Model</span>
                <select id="openai-model" class="select-styled">
                  <option value="gpt-5.1">GPT-5.1 (Best for Coding)</option>
                  <option value="gpt-5-mini">GPT-5 Mini (Fast & Efficient)</option>
                  <option value="gpt-5-nano">GPT-5 Nano (Fastest)</option>
                  <option value="gpt-5-pro">GPT-5 Pro (Most Precise)</option>
                  <option value="gpt-4.1">GPT-4.1 (Non-Reasoning)</option>
                  <option value="gpt-5.1-codex">GPT-5.1 Codex (Coding Optimized)</option>
                </select>
              </label>
              
              <label class="checkbox-label-between">
                <span>Smart Field Mapping</span>
                <input type="checkbox" id="smart-mapping" checked class="checkbox-styled">
              </label>
              
              <div class="flex gap-8">
                <button id="test-api-connection" class="btn btn-secondary flex-1 btn-lg">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" class="svg-mr">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                  </svg>
                  Test Connection
                </button>
                <button id="save-ai-settings" class="btn btn-primary flex-1 btn-lg">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" class="svg-mr">
                    <path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/>
                  </svg>
                  Save Config
                </button>
              </div>
              
              <div id="api-test-result" class="api-test-result hidden"></div>
            </div>
          </div>

          <!-- Autofill Settings -->
          <div class="card-white">
            <div class="section-header flex-row gap-8">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/>
              </svg>
              Auto-Fill Preferences
            </div>
            <div class="flex-col gap-10">
              <label class="form-label">
                <span class="font-semibold">Default Profile</span>
                <select id="autofill-profile" class="select-styled">
                  <optgroup label="ðŸ¦ Financial & Banking">
                    <option value="loan-full">Loan Application (Full)</option>
                    <option value="loan-personal">Personal Loan</option>
                    <option value="loan-mortgage">Mortgage Application</option>
                    <option value="credit-card">Credit Card Application</option>
                    <option value="bank-account">Bank Account Opening</option>
                    <option value="investment">Investment Account</option>
                  </optgroup>
                  <optgroup label="ðŸ’¼ Employment & Jobs">
                    <option value="job-full">Job Application (Full)</option>
                    <option value="job-quick">Job Application (Quick)</option>
                    <option value="resume-info">Resume Information</option>
                    <option value="background-check">Background Check</option>
                    <option value="w9-tax">W-9 Tax Form</option>
                    <option value="i9-employment">I-9 Employment Verification</option>
                  </optgroup>
                  <optgroup label="ðŸ¥ Healthcare & Insurance">
                    <option value="health-insurance">Health Insurance</option>
                    <option value="medical-history">Medical History</option>
                    <option value="prescription">Prescription Request</option>
                    <option value="dental-claim">Dental Claim</option>
                    <option value="life-insurance">Life Insurance</option>
                    <option value="disability-claim">Disability Claim</option>
                  </optgroup>
                  <optgroup label="ðŸŽ“ Education & Schools">
                    <option value="college-admission">College Admission</option>
                    <option value="fafsa">FAFSA (Financial Aid)</option>
                    <option value="scholarship">Scholarship Application</option>
                    <option value="student-registration">Student Registration</option>
                    <option value="transcript-request">Transcript Request</option>
                  </optgroup>
                  <optgroup label="ðŸ  Real Estate & Housing">
                    <option value="rental-app">Rental Application</option>
                    <option value="lease-agreement">Lease Agreement</option>
                    <option value="property-purchase">Property Purchase</option>
                    <option value="homeowners-insurance">Homeowners Insurance</option>
                    <option value="hoa-registration">HOA Registration</option>
                  </optgroup>
                  <optgroup label="ðŸš— Automotive & DMV">
                    <option value="auto-insurance">Auto Insurance Quote</option>
                    <option value="dmv-registration">DMV Vehicle Registration</option>
                    <option value="drivers-license">Driver's License Renewal</option>
                    <option value="car-loan">Car Loan Application</option>
                    <option value="accident-claim">Accident Claim</option>
                  </optgroup>
                  <optgroup label="âœˆï¸ Travel & Visa">
                    <option value="passport-app">Passport Application</option>
                    <option value="visa-app">Visa Application</option>
                    <option value="travel-insurance">Travel Insurance</option>
                    <option value="tsa-precheck">TSA PreCheck</option>
                    <option value="global-entry">Global Entry</option>
                  </optgroup>
                  <optgroup label="ðŸ›’ E-Commerce & Retail">
                    <option value="checkout-full">Checkout (Full)</option>
                    <option value="checkout-quick">Checkout (Quick)</option>
                    <option value="shipping-only">Shipping Address Only</option>
                    <option value="billing-only">Billing Information Only</option>
                    <option value="account-creation">Account Creation</option>
                  </optgroup>
                  <optgroup label="ðŸ“‹ Government & Legal">
                    <option value="tax-return">Tax Return (1040)</option>
                    <option value="business-license">Business License</option>
                    <option value="legal-affidavit">Legal Affidavit</option>
                    <option value="notary-request">Notary Request</option>
                    <option value="court-filing">Court Filing</option>
                    <option value="voter-registration">Voter Registration</option>
                  </optgroup>
                  <optgroup label="ðŸ‘¤ Personal & General">
                    <option value="contact-info">Contact Information Only</option>
                    <option value="demographics">Demographics Only</option>
                    <option value="emergency-contact">Emergency Contact</option>
                    <option value="survey">Survey/Questionnaire</option>
                    <option value="petition">Petition Signature</option>
                  </optgroup>
                  <optgroup label="âš¡ Smart Auto-Select">
                    <option value="auto-detect" selected>ðŸ¤– Auto-Detect Form Type</option>
                  </optgroup>
                </select>
              </label>
              <label class="checkbox-label-between">
                <span>Auto-detect Documents</span>
                <input type="checkbox" checked class="checkbox-styled">
              </label>
              <label class="checkbox-label-between">
                <span>Highlight Filled Fields</span>
                <input type="checkbox" checked class="checkbox-styled">
              </label>
            </div>
          </div>

          <!-- About -->
          <div class="card-white-last">
            <div class="section-header">
              About CUBE OmniFill
            </div>
            <div class="about-content">
              <p><strong>Version:</strong> 5.2.0 Ultimate</p>
              <p><strong>Status:</strong> <span class="text-success">Active</span></p>
              <p class="no-margin">Enterprise-grade universal autofill with AI-powered document parsing, LendingPad integration, voice control, and CRM sync.</p>
            </div>
          </div>

        </div>
      </div>

      <!-- AI Chat Panel -->
      <div id="chat-panel" class="tab-content">
        <div class="ai-chat-container">
          
          <!-- Chat Header -->
          <div class="chat-header">
            <div class="chat-header-content">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
                <circle cx="12" cy="10" r="1.5" fill="white"/>
                <circle cx="8" cy="10" r="1.5" fill="white"/>
                <circle cx="16" cy="10" r="1.5" fill="white"/>
              </svg>
              <div>
                <h3>AI Assistant</h3>
                <span class="chat-subtitle">Helps with PDF detection & auto-fill</span>
              </div>
            </div>
            <div class="chat-status" id="ai-status-indicator">
              <span class="status-dot active"></span>
              <span id="ai-mode-text">Ready</span>
            </div>
          </div>

          <!-- Quick Actions -->
          <div class="chat-quick-actions">
            <button class="quick-action-btn" data-action="detect">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
              </svg>
              <span>Detect PDFs</span>
            </button>
            <button class="quick-action-btn" data-action="parse">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/>
              </svg>
              <span>Parse Docs</span>
            </button>
            <button class="quick-action-btn" data-action="autofill">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
              </svg>
              <span>Auto-fill</span>
            </button>
            <button class="quick-action-btn" data-action="stats">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
              </svg>
              <span>Stats</span>
            </button>
          </div>

          <!-- Chat Messages -->
          <div class="chat-messages" id="chat-messages">
            <div class="chat-empty-state" id="chat-empty">
              <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor" opacity="0.3">
                <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
              </svg>
              <p>Hi! I'm your AI assistant.</p>
              <p class="chat-empty-hint">Ask me to detect PDFs, parse documents, or auto-fill forms!</p>
            </div>
          </div>

          <!-- Chat Suggestions -->
          <div class="chat-suggestions hidden" id="chat-suggestions">
            <!-- Dynamic suggestions will be inserted here -->
          </div>

          <!-- Chat Input -->
          <div class="chat-input-container">
            <textarea 
              id="chat-input" 
              class="chat-input" 
              placeholder="Ask me anything about PDFs or auto-fill..."
              rows="1"
            ></textarea>
            <button id="chat-send-btn" class="chat-send-btn" title="Send message">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
              </svg>
            </button>
          </div>

          <!-- Chat Loading Indicator -->
          <div class="chat-loading hidden" id="chat-loading">
            <div class="chat-loading-dots">
              <span></span>
              <span></span>
              <span></span>
            </div>
            <span>AI is thinking...</span>
          </div>

        </div>
      </div>

    </div>

    <!-- Status Bar -->
    <div class="status-bar">
      <div id="status-message">Ready â€¢ Works on any website</div>
    </div>

    <!-- Footer -->
    <footer>
      <div class="footer-links">
        <a href="#" id="terms-link">Terms</a>
        <span class="footer-dot">â€¢</span>
        <a href="#" id="privacy-link">Privacy</a>
        <span class="footer-dot">â€¢</span>
        <a href="https://cubeadvisors.io" target="_blank" rel="noopener">Website</a>
      </div>
      <div>
        Â© 2025 CUBE Collective LLC. All rights reserved.
      </div>
    </footer>

  </div>

  <script src="download-manager.js"></script>
  <script src="popup-enterprise.js"></script>
</body>
</html>
