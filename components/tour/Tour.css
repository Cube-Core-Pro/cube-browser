/* ============================================================================
   CUBE Tour Styles - Unified Theme System
   Sistema de tour interactivo para guiar usuarios
   Compatible con todos los temas de la aplicaci√≥n
   ============================================================================ */

/* Tour variables - inherits from global theme */
.tour-tooltip,
.tour-overlay,
.tour-launcher,
.tour-welcome-modal,
.tour-completion-modal {
  --tour-bg: var(--bg-elevated, #1e293b);
  --tour-bg-secondary: var(--bg-secondary, #334155);
  --tour-text: var(--text-primary, #f1f5f9);
  --tour-text-secondary: var(--text-secondary, #94a3b8);
  --tour-accent: var(--color-accent-500, #06b6d4);
  --tour-accent-hover: var(--color-accent-400, #22d3ee);
  --tour-success: var(--color-success, #10b981);
  --tour-warning: var(--color-warning, #f59e0b);
  --tour-error: var(--color-error, #ef4444);
  --tour-border: var(--border-primary, rgba(148, 163, 184, 0.2));
  --tour-shadow: var(--shadow-xl, 0 25px 50px -12px rgba(0, 0, 0, 0.5));
  --tour-radius: var(--radius-xl, 16px);
  --tour-radius-sm: var(--radius-md, 8px);
}

/* ============================================================================
   Tour Overlay
   ============================================================================ */

.tour-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: 9998;
  pointer-events: none;
}

.tour-overlay-svg {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

/* Highlight styles */
.tour-highlight {
  position: fixed;
  top: var(--highlight-top, 0);
  left: var(--highlight-left, 0);
  width: var(--highlight-width, 0);
  height: var(--highlight-height, 0);
  border-radius: var(--tour-radius-sm);
  pointer-events: none;
  transition: all 0.3s ease;
}

.tour-highlight.border {
  border: 3px solid var(--tour-accent);
  box-shadow: 0 0 0 4px rgba(6, 182, 212, 0.2);
}

.tour-highlight.spotlight {
  box-shadow: 
    0 0 0 4px rgba(6, 182, 212, 0.4),
    0 0 30px rgba(6, 182, 212, 0.3);
}

.tour-highlight.pulse {
  animation: tour-pulse 2s infinite;
  box-shadow: 0 0 0 4px rgba(6, 182, 212, 0.4);
}

.tour-highlight.glow {
  box-shadow: 
    0 0 20px rgba(6, 182, 212, 0.6),
    0 0 40px rgba(6, 182, 212, 0.4),
    0 0 60px rgba(6, 182, 212, 0.2);
}

/* Highlight intensity */
.tour-overlay.subtle .tour-overlay-svg rect[fill*="rgba"] {
  fill: rgba(0, 0, 0, 0.5);
}

.tour-overlay.prominent .tour-overlay-svg rect[fill*="rgba"] {
  fill: rgba(0, 0, 0, 0.85);
}

.tour-overlay.prominent .tour-highlight {
  box-shadow: 
    0 0 0 6px rgba(6, 182, 212, 0.5),
    0 0 50px rgba(6, 182, 212, 0.4);
}

@keyframes tour-pulse {
  0%, 100% {
    box-shadow: 0 0 0 4px rgba(6, 182, 212, 0.4);
  }
  50% {
    box-shadow: 0 0 0 8px rgba(6, 182, 212, 0.2), 0 0 20px rgba(6, 182, 212, 0.3);
  }
}

/* ============================================================================
   Tour Tooltip
   ============================================================================ */

.tour-tooltip {
  position: fixed;
  top: var(--tooltip-top, 50%);
  left: var(--tooltip-left, 50%);
  width: 420px;
  max-width: calc(100vw - 32px);
  background: var(--tour-bg);
  border: 1px solid var(--tour-border);
  border-radius: var(--tour-radius);
  box-shadow: var(--tour-shadow);
  z-index: 9999;
  opacity: 0;
  transform: translateY(10px) scale(0.98);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  overflow: hidden;
}

.tour-tooltip.visible {
  opacity: 1;
  transform: translateY(0) scale(1);
}

.tour-tooltip.paused {
  opacity: 0.8;
  filter: grayscale(0.3);
}

/* Arrow indicators based on position */
.tour-tooltip::before {
  content: '';
  position: absolute;
  width: 12px;
  height: 12px;
  background: var(--tour-bg);
  border: 1px solid var(--tour-border);
  transform: rotate(45deg);
}

.tour-tooltip[data-position^="bottom"]::before {
  top: -7px;
  left: 50%;
  margin-left: -6px;
  border-right: none;
  border-bottom: none;
}

.tour-tooltip[data-position^="top"]::before {
  bottom: -7px;
  left: 50%;
  margin-left: -6px;
  border-left: none;
  border-top: none;
}

.tour-tooltip[data-position^="left"]::before {
  right: -7px;
  top: 50%;
  margin-top: -6px;
  border-left: none;
  border-bottom: none;
}

.tour-tooltip[data-position^="right"]::before {
  left: -7px;
  top: 50%;
  margin-top: -6px;
  border-right: none;
  border-top: none;
}

.tour-tooltip[data-position="center"]::before {
  display: none;
}

/* Header */
.tour-tooltip-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  border-bottom: 1px solid var(--tour-border);
  background: var(--tour-bg-secondary);
}

.tour-tooltip-category {
  display: flex;
  align-items: center;
  gap: 8px;
}

.category-badge {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 4px 10px;
  border-radius: 20px;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.category-badge.welcome {
  background: rgba(168, 85, 247, 0.2);
  color: #c084fc;
}

.category-badge.settings {
  background: rgba(59, 130, 246, 0.2);
  color: #60a5fa;
}

.category-badge.contacts {
  background: rgba(16, 185, 129, 0.2);
  color: #34d399;
}

.category-badge.campaigns {
  background: rgba(6, 182, 212, 0.2);
  color: #22d3ee;
}

.category-badge.analytics {
  background: rgba(245, 158, 11, 0.2);
  color: #fbbf24;
}

.category-badge.advanced {
  background: rgba(239, 68, 68, 0.2);
  color: #f87171;
}

.category-badge.tips {
  background: rgba(34, 197, 94, 0.2);
  color: #4ade80;
}

.optional-badge {
  padding: 2px 8px;
  border-radius: 4px;
  font-size: 10px;
  font-weight: 500;
  background: rgba(148, 163, 184, 0.2);
  color: var(--tour-text-secondary);
}

.tour-tooltip-controls {
  display: flex;
  gap: 4px;
}

.tour-control-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  border: none;
  border-radius: 6px;
  background: transparent;
  color: var(--tour-text-secondary);
  cursor: pointer;
  transition: all 0.2s;
}

.tour-control-btn:hover {
  background: rgba(148, 163, 184, 0.2);
  color: var(--tour-text);
}

.tour-control-btn.close:hover {
  background: rgba(239, 68, 68, 0.2);
  color: var(--tour-error);
}

/* Progress bar */
.tour-progress-bar {
  height: 3px;
  background: var(--tour-border);
}

.tour-progress-fill {
  height: 100%;
  width: var(--progress-width, 0%);
  background: linear-gradient(90deg, var(--tour-accent), var(--tour-success));
  transition: width 0.3s ease;
}

/* Content */
.tour-tooltip-content {
  padding: 20px;
}

.tour-tooltip-title {
  margin: 0 0 12px 0;
  font-size: 18px;
  font-weight: 700;
  color: var(--tour-text);
  line-height: 1.3;
}

.tour-tooltip-description {
  margin: 0 0 16px 0;
  font-size: 14px;
  line-height: 1.6;
  color: var(--tour-text-secondary);
}

/* Media */
.tour-tooltip-media {
  margin: 16px 0;
  border-radius: var(--tour-radius-sm);
  overflow: hidden;
  border: 1px solid var(--tour-border);
}

.tour-tooltip-media img {
  width: 100%;
  height: auto;
  display: block;
}

/* Tips */
.tour-tooltip-tips {
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px solid var(--tour-border);
}

.tips-toggle {
  display: flex;
  align-items: center;
  gap: 8px;
  width: 100%;
  padding: 8px 12px;
  border: none;
  border-radius: var(--tour-radius-sm);
  background: rgba(250, 204, 21, 0.1);
  color: #fbbf24;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
}

.tips-toggle:hover {
  background: rgba(250, 204, 21, 0.15);
}

.tips-toggle svg:last-child {
  margin-left: auto;
  transition: transform 0.2s;
}

.tips-toggle svg:last-child.rotated {
  transform: rotate(90deg);
}

.tips-list {
  margin: 12px 0 0 0;
  padding: 0;
  list-style: none;
}

.tips-list li {
  display: flex;
  align-items: flex-start;
  gap: 8px;
  padding: 8px 0;
  font-size: 13px;
  color: var(--tour-text-secondary);
  border-bottom: 1px solid var(--tour-border);
}

.tips-list li:last-child {
  border-bottom: none;
}

.tips-list li svg {
  flex-shrink: 0;
  margin-top: 2px;
  color: var(--tour-success);
}

/* Competitive advantage */
.tour-tooltip-advantage {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  margin-top: 16px;
  padding: 12px;
  border-radius: var(--tour-radius-sm);
  background: linear-gradient(135deg, rgba(6, 182, 212, 0.1), rgba(168, 85, 247, 0.1));
  border: 1px solid rgba(6, 182, 212, 0.2);
}

.tour-tooltip-advantage svg {
  flex-shrink: 0;
  color: #fbbf24;
}

.tour-tooltip-advantage span {
  font-size: 13px;
  line-height: 1.5;
  color: var(--tour-text-secondary);
}

.tour-tooltip-advantage strong {
  color: var(--tour-accent);
}

/* Action button */
.tour-action-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  width: 100%;
  margin-top: 16px;
  padding: 12px;
  border: none;
  border-radius: var(--tour-radius-sm);
  background: linear-gradient(135deg, var(--tour-accent), #8b5cf6);
  color: white;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
}

.tour-action-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 10px 20px rgba(6, 182, 212, 0.3);
}

/* Footer */
.tour-tooltip-footer {
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding: 16px 20px;
  border-top: 1px solid var(--tour-border);
  background: var(--tour-bg-secondary);
}

.tour-step-info {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 12px;
  color: var(--tour-text-secondary);
}

.step-counter {
  font-weight: 600;
  color: var(--tour-accent);
}

.section-name {
  opacity: 0.7;
}

/* Navigation */
.tour-navigation {
  display: flex;
  gap: 8px;
}

.tour-nav-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 10px 16px;
  border: none;
  border-radius: var(--tour-radius-sm);
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
}

.tour-nav-btn.prev {
  background: transparent;
  border: 1px solid var(--tour-border);
  color: var(--tour-text-secondary);
}

.tour-nav-btn.prev:hover:not(:disabled) {
  background: rgba(148, 163, 184, 0.1);
  color: var(--tour-text);
}

.tour-nav-btn.prev:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

.tour-nav-btn.skip {
  background: transparent;
  color: var(--tour-text-secondary);
}

.tour-nav-btn.skip:hover {
  color: var(--tour-warning);
}

.tour-nav-btn.next {
  flex: 1;
  justify-content: center;
  background: var(--tour-accent);
  color: white;
}

.tour-nav-btn.next:hover {
  background: var(--tour-accent-hover);
}

/* Keyboard hint */
.tour-keyboard-hint {
  display: flex;
  justify-content: center;
  gap: 16px;
  padding: 8px 20px;
  border-top: 1px solid var(--tour-border);
  font-size: 11px;
  color: var(--tour-text-secondary);
  opacity: 0.6;
}

.tour-keyboard-hint span {
  display: flex;
  align-items: center;
  gap: 4px;
}

/* ============================================================================
   Welcome Modal
   ============================================================================ */

.tour-welcome-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.8);
  -webkit-backdrop-filter: blur(8px);
  backdrop-filter: blur(8px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  animation: fadeIn 0.3s ease;
}

.tour-welcome-modal {
  width: 600px;
  max-width: calc(100vw - 32px);
  max-height: calc(100vh - 32px);
  background: var(--tour-bg);
  border-radius: var(--tour-radius);
  border: 1px solid var(--tour-border);
  box-shadow: var(--tour-shadow);
  overflow: hidden;
  animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(30px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.tour-welcome-header {
  padding: 32px;
  text-align: center;
  background: linear-gradient(135deg, rgba(6, 182, 212, 0.15), rgba(168, 85, 247, 0.15));
  border-bottom: 1px solid var(--tour-border);
}

.tour-welcome-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 64px;
  height: 64px;
  margin-bottom: 16px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--tour-accent), #8b5cf6);
  animation: pulse-icon 2s infinite;
}

@keyframes pulse-icon {
  0%, 100% {
    box-shadow: 0 0 0 0 rgba(6, 182, 212, 0.4);
  }
  50% {
    box-shadow: 0 0 0 20px rgba(6, 182, 212, 0);
  }
}

.tour-welcome-header h2 {
  margin: 0 0 8px 0;
  font-size: 24px;
  font-weight: 700;
  color: var(--tour-text);
}

.tour-welcome-header p {
  margin: 0;
  font-size: 14px;
  color: var(--tour-text-secondary);
}

.tour-welcome-content {
  padding: 24px 32px;
  max-height: 400px;
  overflow-y: auto;
}

.tour-sections-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.tour-section-item {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 16px;
  border-radius: var(--tour-radius-sm);
  background: var(--tour-bg-secondary);
  border: 1px solid transparent;
  cursor: pointer;
  transition: all 0.2s;
}

.tour-section-item:hover {
  border-color: var(--tour-accent);
  transform: translateX(4px);
}

.tour-section-item.completed {
  opacity: 0.6;
}

.section-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 44px;
  height: 44px;
  border-radius: 12px;
  font-size: 20px;
}

.section-icon.welcome { background: rgba(168, 85, 247, 0.2); }
.section-icon.settings { background: rgba(59, 130, 246, 0.2); }
.section-icon.contacts { background: rgba(16, 185, 129, 0.2); }
.section-icon.campaigns { background: rgba(6, 182, 212, 0.2); }
.section-icon.analytics { background: rgba(245, 158, 11, 0.2); }
.section-icon.advanced { background: rgba(239, 68, 68, 0.2); }

.section-info {
  flex: 1;
}

.section-info h4 {
  margin: 0 0 4px 0;
  font-size: 14px;
  font-weight: 600;
  color: var(--tour-text);
}

.section-info p {
  margin: 0;
  font-size: 12px;
  color: var(--tour-text-secondary);
}

.section-meta {
  display: flex;
  align-items: center;
  gap: 12px;
  font-size: 11px;
  color: var(--tour-text-secondary);
}

.section-meta span {
  display: flex;
  align-items: center;
  gap: 4px;
}

.difficulty-badge {
  padding: 2px 8px;
  border-radius: 4px;
  font-size: 10px;
  font-weight: 600;
  text-transform: uppercase;
}

.difficulty-badge.beginner {
  background: rgba(16, 185, 129, 0.2);
  color: #34d399;
}

.difficulty-badge.intermediate {
  background: rgba(245, 158, 11, 0.2);
  color: #fbbf24;
}

.difficulty-badge.advanced {
  background: rgba(239, 68, 68, 0.2);
  color: #f87171;
}

.tour-welcome-footer {
  display: flex;
  gap: 12px;
  padding: 20px 32px;
  border-top: 1px solid var(--tour-border);
  background: var(--tour-bg-secondary);
}

.tour-welcome-btn {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 14px;
  border: none;
  border-radius: var(--tour-radius-sm);
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
}

.tour-welcome-btn.secondary {
  background: transparent;
  border: 1px solid var(--tour-border);
  color: var(--tour-text-secondary);
}

.tour-welcome-btn.secondary:hover {
  background: rgba(148, 163, 184, 0.1);
  color: var(--tour-text);
}

.tour-welcome-btn.primary {
  background: linear-gradient(135deg, var(--tour-accent), #8b5cf6);
  color: white;
}

.tour-welcome-btn.primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 10px 20px rgba(6, 182, 212, 0.3);
}

/* ============================================================================
   Completion Modal
   ============================================================================ */

.tour-completion-header {
  text-align: center;
  padding: 40px 32px;
  background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(6, 182, 212, 0.2));
}

.tour-completion-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 80px;
  height: 80px;
  margin-bottom: 20px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--tour-success), var(--tour-accent));
  animation: celebrate 0.6s ease;
}

@keyframes celebrate {
  0% { transform: scale(0); }
  50% { transform: scale(1.2); }
  100% { transform: scale(1); }
}

.tour-completion-stats {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
  padding: 24px 32px;
}

.completion-stat {
  text-align: center;
  padding: 16px;
  border-radius: var(--tour-radius-sm);
  background: var(--tour-bg-secondary);
}

.completion-stat .value {
  display: block;
  font-size: 24px;
  font-weight: 700;
  color: var(--tour-accent);
}

.completion-stat .label {
  display: block;
  font-size: 12px;
  color: var(--tour-text-secondary);
  margin-top: 4px;
}

/* ============================================================================
   Start Tour Button
   ============================================================================ */

.tour-start-btn {
  position: fixed;
  bottom: 24px;
  right: 24px;
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 14px 24px;
  border: none;
  border-radius: 50px;
  background: linear-gradient(135deg, var(--tour-accent), #8b5cf6);
  color: white;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  box-shadow: 0 10px 30px rgba(6, 182, 212, 0.4);
  transition: all 0.3s;
  z-index: 1000;
}

.tour-start-btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 15px 40px rgba(6, 182, 212, 0.5);
}

.tour-start-btn .badge {
  padding: 2px 8px;
  border-radius: 10px;
  background: rgba(255, 255, 255, 0.2);
  font-size: 11px;
}

/* ============================================================================
   Responsive
   ============================================================================ */

@media (max-width: 768px) {
  .tour-tooltip {
    width: calc(100vw - 32px);
    max-height: calc(100vh - 100px);
    overflow-y: auto;
  }

  .tour-tooltip::before {
    display: none;
  }

  .tour-welcome-modal {
    width: calc(100vw - 32px);
  }

  .tour-completion-stats {
    grid-template-columns: 1fr;
  }

  .tour-keyboard-hint {
    display: none;
  }

  .tour-navigation {
    flex-direction: column;
  }

  .tour-nav-btn.next {
    order: -1;
  }
}

/* ============================================================================
   Tour Launcher
   ============================================================================ */

.tour-launcher-container {
  position: fixed;
  /* Position controlled by JS via style prop */
  z-index: 9900;
  /* Ensure it floats above canvas content */
  pointer-events: auto;
  isolation: isolate;
  /* Smooth transition when not dragging */
  transition: opacity 0.2s ease;
}

.tour-launcher-container.dragging {
  cursor: grabbing !important;
  -webkit-user-select: none;
  user-select: none;
  transition: none;
}

.tour-launcher-container.dragging .tour-launcher-fab {
  cursor: grabbing !important;
  transform: scale(1.1);
  opacity: 1;
  box-shadow: 
    0 8px 24px rgba(6, 182, 212, 0.5),
    0 4px 12px rgba(0, 0, 0, 0.2);
}

.tour-launcher-fab {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, #0891b2, #06b6d4);
  border: none;
  cursor: grab;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 
    0 4px 16px rgba(6, 182, 212, 0.4),
    0 2px 8px rgba(0, 0, 0, 0.15);
  transition: all 0.2s ease;
  position: relative;
  opacity: 0.85;
}

.tour-launcher-fab:active {
  cursor: grabbing;
}

.tour-launcher-fab:hover {
  transform: scale(1.1);
  opacity: 1;
  box-shadow: 
    0 6px 24px rgba(6, 182, 212, 0.5),
    0 4px 12px rgba(0, 0, 0, 0.2);
}

.tour-launcher-fab .tour-launcher-icon {
  font-size: 18px;
  line-height: 1;
  /* Ensure emoji is visible on any background */
  filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
}

.tour-launcher-progress {
  position: absolute;
  top: -4px;
  left: -4px;
  right: -4px;
  bottom: -4px;
}

.tour-launcher-progress-ring {
  width: 100%;
  height: 100%;
  transform: rotate(-90deg);
}

.tour-launcher-progress-bg {
  opacity: 0.2;
  stroke: white;
}

.tour-launcher-progress-fill {
  stroke: white;
  transition: stroke-dasharray 0.3s ease;
}

/* Launcher Menu - Smart positioning */
.tour-launcher-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  -webkit-backdrop-filter: blur(4px);
  backdrop-filter: blur(4px);
  z-index: -1;
}

.tour-launcher-menu {
  position: absolute;
  width: 320px;
  max-height: calc(100vh - 120px);
  overflow-y: auto;
  /* Solid background for better contrast */
  background: var(--tour-bg);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  backdrop-filter: blur(20px) saturate(180%);
  border: 1px solid var(--tour-border);
  border-radius: var(--tour-radius);
  box-shadow: 
    var(--tour-shadow),
    0 0 0 1px rgba(255, 255, 255, 0.05);
  overflow-x: hidden;
}

/* Default: Opens above and to the right */
.tour-launcher-menu.tour-menu-above {
  bottom: calc(100% + 12px);
  animation: tour-menu-slide-up 250ms cubic-bezier(0.4, 0, 0.2, 1);
}

.tour-launcher-menu.tour-menu-below {
  top: calc(100% + 12px);
  bottom: auto;
  animation: tour-menu-slide-down 250ms cubic-bezier(0.4, 0, 0.2, 1);
}

.tour-launcher-menu.tour-menu-right {
  right: 0;
  left: auto;
}

.tour-launcher-menu.tour-menu-left {
  left: 0;
  right: auto;
}

@keyframes tour-menu-slide-up {
  from {
    opacity: 0;
    transform: translateY(12px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes tour-menu-slide-down {
  from {
    opacity: 0;
    transform: translateY(-12px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.tour-launcher-menu-header {
  padding: 20px;
  background: linear-gradient(135deg, var(--tour-accent), #0891b2);
  color: white;
}

.tour-launcher-menu-header h3 {
  margin: 0 0 4px;
  font-size: 18px;
  font-weight: 600;
}

.tour-launcher-menu-header p {
  margin: 0;
  font-size: 13px;
  opacity: 0.9;
}

.tour-launcher-menu-item {
  display: flex;
  align-items: center;
  gap: 12px;
  width: 100%;
  padding: 14px 20px;
  border: none;
  background: transparent;
  color: var(--tour-text);
  cursor: pointer;
  transition: background 0.2s ease;
  text-align: left;
}

.tour-launcher-menu-item:hover {
  background: var(--tour-bg-secondary);
}

.tour-launcher-menu-item.tour-launcher-menu-main {
  background: rgba(6, 182, 212, 0.1);
  border-bottom: 1px solid var(--tour-border);
}

.tour-launcher-menu-item.completed {
  opacity: 0.6;
}

.tour-launcher-menu-icon {
  font-size: 20px;
  width: 28px;
  text-align: center;
  flex-shrink: 0;
}

.tour-launcher-menu-content {
  flex: 1;
  min-width: 0;
}

.tour-launcher-menu-title {
  display: block;
  font-size: 14px;
  font-weight: 500;
}

.tour-launcher-menu-subtitle {
  display: block;
  font-size: 12px;
  color: var(--tour-text-secondary);
  margin-top: 2px;
}

.tour-launcher-section-progress {
  font-size: 12px;
  color: var(--tour-accent);
  font-weight: 500;
}

.tour-launcher-menu-divider {
  padding: 8px 20px;
  font-size: 11px;
  color: var(--tour-text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border-top: 1px solid var(--tour-border);
  margin-top: 8px;
}

.tour-launcher-sections {
  max-height: 280px;
  overflow-y: auto;
}

.tour-launcher-menu-footer {
  padding: 12px 20px;
  border-top: 1px solid var(--tour-border);
  display: flex;
  justify-content: center;
}

.tour-launcher-menu-reset {
  font-size: 12px;
  color: var(--tour-text-secondary);
  background: none;
  border: none;
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 4px;
  transition: all 0.2s ease;
}

.tour-launcher-menu-reset:hover {
  color: var(--tour-error);
  background: rgba(239, 68, 68, 0.1);
}

/* Launcher Button variant */
.tour-launcher-button {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 10px 20px;
  background: linear-gradient(135deg, var(--tour-accent), #0891b2);
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s ease;
}

.tour-launcher-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(6, 182, 212, 0.4);
}

.tour-launcher-button .tour-launcher-icon {
  font-size: 18px;
}

/* Launcher Minimal variant */
.tour-launcher-minimal {
  position: relative;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background: var(--tour-bg-secondary);
  border: 1px solid var(--tour-border);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

.tour-launcher-minimal:hover {
  background: var(--tour-accent);
  border-color: var(--tour-accent);
}

.tour-launcher-minimal .tour-launcher-icon {
  font-size: 16px;
}

.tour-launcher-badge {
  position: absolute;
  top: -6px;
  right: -6px;
  background: var(--tour-accent);
  color: white;
  font-size: 10px;
  font-weight: 600;
  padding: 2px 5px;
  border-radius: 10px;
  line-height: 1;
}

/* ============================================================================
   Tour Modal (Welcome & Completion)
   ============================================================================ */

.tour-modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  animation: tour-fade-in 0.3s ease;
}

.tour-modal {
  position: relative;
  width: 90%;
  max-width: 480px;
  background: var(--tour-bg);
  border-radius: var(--tour-radius);
  padding: 40px;
  box-shadow: var(--tour-shadow);
  animation: tour-modal-slide 0.3s ease;
  text-align: center;
}

@keyframes tour-modal-slide {
  from {
    opacity: 0;
    transform: scale(0.95) translateY(20px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.tour-modal-close {
  position: absolute;
  top: 16px;
  right: 16px;
  width: 32px;
  height: 32px;
  border: none;
  background: var(--tour-bg-secondary);
  border-radius: 50%;
  color: var(--tour-text-secondary);
  font-size: 20px;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.tour-modal-close:hover {
  background: var(--tour-error);
  color: white;
}

/* Welcome Modal */
.tour-welcome-icon {
  font-size: 64px;
  margin-bottom: 16px;
  animation: tour-bounce 1s ease infinite;
}

@keyframes tour-bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}

.tour-welcome-title {
  font-size: 24px;
  font-weight: 700;
  color: var(--tour-text);
  margin: 0 0 8px;
}

.tour-welcome-subtitle {
  font-size: 15px;
  color: var(--tour-text-secondary);
  margin: 0 0 32px;
}

.tour-welcome-features {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  margin-bottom: 24px;
}

.tour-welcome-feature {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px;
  background: var(--tour-bg-secondary);
  border-radius: var(--tour-radius-sm);
  font-size: 13px;
  color: var(--tour-text);
}

.tour-welcome-feature-icon {
  font-size: 18px;
}

.tour-welcome-stats {
  display: flex;
  justify-content: center;
  gap: 32px;
  margin-bottom: 32px;
  padding: 16px 0;
  border-top: 1px solid var(--tour-border);
  border-bottom: 1px solid var(--tour-border);
}

.tour-welcome-stat {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.tour-welcome-stat-value {
  font-size: 28px;
  font-weight: 700;
  color: var(--tour-accent);
  line-height: 1;
}

.tour-welcome-stat-label {
  font-size: 12px;
  color: var(--tour-text-secondary);
  margin-top: 4px;
}

.tour-welcome-actions {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.tour-welcome-btn {
  padding: 14px 28px;
  border-radius: var(--tour-radius-sm);
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  border: none;
}

.tour-welcome-btn-primary {
  background: linear-gradient(135deg, var(--tour-accent), #0891b2);
  color: white;
}

.tour-welcome-btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 10px 25px rgba(6, 182, 212, 0.4);
}

.tour-welcome-btn-secondary {
  background: transparent;
  color: var(--tour-text-secondary);
  border: 1px solid var(--tour-border);
}

.tour-welcome-btn-secondary:hover {
  background: var(--tour-bg-secondary);
  color: var(--tour-text);
}

.tour-welcome-tip {
  margin-top: 24px;
  font-size: 13px;
  color: var(--tour-text-secondary);
}

/* Completion Modal */
.tour-completion-confetti {
  font-size: 80px;
  margin-bottom: 16px;
  animation: tour-celebrate 0.6s ease;
}

@keyframes tour-celebrate {
  0% { transform: scale(0) rotate(-45deg); }
  50% { transform: scale(1.2) rotate(10deg); }
  100% { transform: scale(1) rotate(0); }
}

.tour-completion-title {
  font-size: 24px;
  font-weight: 700;
  color: var(--tour-text);
  margin: 0 0 8px;
}

.tour-completion-subtitle {
  font-size: 15px;
  color: var(--tour-text-secondary);
  margin: 0 0 24px;
}

.tour-completion-achievements {
  display: flex;
  justify-content: center;
  gap: 16px;
  margin-bottom: 24px;
}

.tour-completion-achievement {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  padding: 12px 16px;
  background: var(--tour-bg-secondary);
  border-radius: var(--tour-radius-sm);
}

.tour-completion-achievement-icon {
  font-size: 24px;
}

.tour-completion-achievement-text {
  font-size: 11px;
  color: var(--tour-text-secondary);
}

.tour-completion-next-steps {
  text-align: left;
  background: var(--tour-bg-secondary);
  border-radius: var(--tour-radius-sm);
  padding: 16px 20px;
  margin-bottom: 24px;
}

.tour-completion-next-steps h3 {
  font-size: 14px;
  font-weight: 600;
  color: var(--tour-text);
  margin: 0 0 12px;
}

.tour-completion-next-steps ol {
  margin: 0;
  padding-left: 20px;
  font-size: 13px;
  color: var(--tour-text-secondary);
}

.tour-completion-next-steps li {
  margin-bottom: 6px;
}

.tour-completion-actions {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.tour-completion-btn {
  padding: 14px 28px;
  border-radius: var(--tour-radius-sm);
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  border: none;
}

.tour-completion-btn-primary {
  background: linear-gradient(135deg, var(--tour-success), #059669);
  color: white;
}

.tour-completion-btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 10px 25px rgba(16, 185, 129, 0.4);
}

.tour-completion-btn-secondary {
  background: transparent;
  color: var(--tour-text-secondary);
  border: 1px solid var(--tour-border);
}

.tour-completion-btn-secondary:hover {
  background: var(--tour-bg-secondary);
  color: var(--tour-text);
}

.tour-completion-support {
  margin-top: 20px;
  font-size: 13px;
  color: var(--tour-text-secondary);
}

/* ============================================================================
   Light Mode Overrides
   ============================================================================ */

:root[data-theme="light"] .tour-tooltip,
:root[data-theme="light"] .tour-overlay,
:root[data-theme="light"] .tour-launcher,
:root[data-theme="light"] .tour-welcome-modal,
:root[data-theme="light"] .tour-completion-modal,
:root[data-theme="light"] .tour-launcher-menu {
  --tour-bg: #ffffff;
  --tour-bg-secondary: #f3f4f6;
  --tour-text: #1f2937;
  --tour-text-secondary: #6b7280;
  --tour-border: rgba(0, 0, 0, 0.1);
  --tour-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
}

:root[data-theme="light"] .tour-launcher-fab {
  box-shadow: 
    0 2px 12px rgba(6, 182, 212, 0.35),
    0 2px 6px rgba(0, 0, 0, 0.15);
}

:root[data-theme="light"] .tour-launcher-fab:hover {
  box-shadow: 
    0 4px 20px rgba(6, 182, 212, 0.45),
    0 4px 12px rgba(0, 0, 0, 0.2);
}

:root[data-theme="light"] .tour-launcher-menu {
  background: #ffffff;
  border: 1px solid rgba(0, 0, 0, 0.12);
  box-shadow: 
    0 20px 40px -10px rgba(0, 0, 0, 0.2),
    0 0 0 1px rgba(0, 0, 0, 0.05);
}

:root[data-theme="light"] .tour-launcher-menu-header {
  background: linear-gradient(135deg, #0891b2, #06b6d4);
}

:root[data-theme="light"] .tour-launcher-menu-item {
  color: #1f2937;
}

:root[data-theme="light"] .tour-launcher-menu-item:hover {
  background: #f3f4f6;
}

:root[data-theme="light"] .tour-launcher-menu-item.tour-launcher-menu-main {
  background: rgba(6, 182, 212, 0.08);
}

:root[data-theme="light"] .tour-launcher-backdrop {
  background: rgba(0, 0, 0, 0.5);
}

:root[data-theme="light"] .tour-tooltip {
  background: #ffffff;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 
    0 20px 40px -10px rgba(0, 0, 0, 0.2),
    0 0 0 1px rgba(0, 0, 0, 0.05);
}

:root[data-theme="light"] .tour-tooltip::before {
  background: #ffffff;
  border-color: rgba(0, 0, 0, 0.1);
}

:root[data-theme="light"] .tour-modal-overlay {
  background: rgba(0, 0, 0, 0.4);
}

:root[data-theme="light"] .tour-modal {
  background: #ffffff;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 25px 60px -10px rgba(0, 0, 0, 0.3);
}

:root[data-theme="light"] .tour-modal-close {
  color: #6b7280;
}

:root[data-theme="light"] .tour-modal-close:hover {
  background: #f3f4f6;
  color: #1f2937;
}

:root[data-theme="light"] .tour-welcome-title,
:root[data-theme="light"] .tour-completion-title {
  color: #1f2937;
}

:root[data-theme="light"] .tour-welcome-subtitle,
:root[data-theme="light"] .tour-completion-subtitle {
  color: #6b7280;
}

:root[data-theme="light"] .tour-welcome-feature {
  background: #f3f4f6;
  border-color: rgba(0, 0, 0, 0.08);
  color: #374151;
}

:root[data-theme="light"] .tour-welcome-stat {
  background: #f9fafb;
  border-color: rgba(0, 0, 0, 0.06);
}

:root[data-theme="light"] .tour-welcome-stat-value {
  color: #0891b2;
}

:root[data-theme="light"] .tour-welcome-stat-label {
  color: #6b7280;
}

:root[data-theme="light"] .tour-welcome-tip {
  background: rgba(6, 182, 212, 0.08);
  color: #0891b2;
}

:root[data-theme="light"] .tour-completion-achievement {
  background: #f3f4f6;
  border-color: rgba(0, 0, 0, 0.08);
  color: #374151;
}

:root[data-theme="light"] .tour-completion-next-steps {
  background: #f9fafb;
  color: #374151;
}

:root[data-theme="light"] .tour-completion-next-steps h3 {
  color: #1f2937;
}

:root[data-theme="light"] .tour-completion-btn-secondary {
  color: #6b7280;
  border-color: rgba(0, 0, 0, 0.15);
}

:root[data-theme="light"] .tour-completion-btn-secondary:hover {
  background: #f3f4f6;
  color: #1f2937;
}

/* Mobile responsive for launcher */
@media (max-width: 768px) {
  .tour-launcher-menu {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    width: 100%;
    border-radius: var(--tour-radius) var(--tour-radius) 0 0;
    max-height: 80vh;
    overflow-y: auto;
  }

  .tour-launcher-menu-v2 {
    position: fixed !important;
    bottom: 0 !important;
    left: 0 !important;
    right: 0 !important;
    top: auto !important;
    width: 100% !important;
    border-radius: var(--tour-radius) var(--tour-radius) 0 0;
    max-height: 80vh !important;
  }

  .tour-modal {
    width: calc(100% - 32px);
    padding: 32px 24px;
    max-height: 90vh;
    overflow-y: auto;
  }

  .tour-welcome-features {
    grid-template-columns: 1fr;
  }

  .tour-welcome-stats {
    gap: 20px;
  }

  .tour-completion-achievements {
    flex-wrap: wrap;
    gap: 8px;
  }
}

/* ============================================================================
   Tour Launcher V2 - Enterprise-grade floating button with smart positioning
   Same quality as AIFloatingChatComplete
   ============================================================================ */

.tour-launcher-fab-v2 {
  position: fixed;
  left: var(--fab-pos-x, 20px);
  top: var(--fab-pos-y, calc(100vh - 80px));
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, #0891b2, #06b6d4);
  border: 2px solid rgba(255, 255, 255, 0.2);
  cursor: grab;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 
    0 4px 16px rgba(6, 182, 212, 0.4),
    0 2px 8px rgba(0, 0, 0, 0.15);
  transition: box-shadow 150ms ease, transform 150ms ease;
  z-index: 9900;
  touch-action: none;
  -webkit-user-select: none;
  user-select: none;
  transform: translateZ(0);
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}

.tour-launcher-fab-v2:hover {
  transform: translateZ(0) scale(1.1);
  box-shadow: 
    0 6px 24px rgba(6, 182, 212, 0.5),
    0 4px 12px rgba(0, 0, 0, 0.2);
}

.tour-launcher-fab-v2.dragging {
  cursor: grabbing;
  transform: translateZ(0) scale(1.1);
  transition: none;
  box-shadow: 
    0 8px 32px rgba(6, 182, 212, 0.6),
    0 4px 16px rgba(0, 0, 0, 0.25);
}

.tour-launcher-fab-v2 .tour-launcher-icon {
  font-size: 18px;
  line-height: 1;
  filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
}

.tour-launcher-fab-v2 .tour-launcher-progress {
  position: absolute;
  top: -4px;
  left: -4px;
  right: -4px;
  bottom: -4px;
}

.tour-launcher-backdrop-v2 {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.4);
  -webkit-backdrop-filter: blur(4px);
  backdrop-filter: blur(4px);
  z-index: 9901;
  animation: tour-backdrop-fade 200ms ease;
}

@keyframes tour-backdrop-fade {
  from { opacity: 0; }
  to { opacity: 1; }
}

.tour-launcher-menu-v2 {
  /* Position via CSS custom properties from JS */
  position: fixed;
  left: var(--menu-pos-x, 50%);
  top: var(--menu-pos-y, 50%);
  width: var(--menu-width, 320px);
  max-height: var(--menu-max-height, 420px);
  z-index: 9902;
  background: var(--tour-bg);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  backdrop-filter: blur(20px) saturate(180%);
  border: 1px solid var(--tour-border);
  border-radius: var(--tour-radius);
  box-shadow: 
    0 25px 50px -12px rgba(0, 0, 0, 0.35),
    0 0 0 1px rgba(255, 255, 255, 0.05);
  overflow: hidden;
  animation: tour-menu-appear 250ms cubic-bezier(0.16, 1, 0.3, 1);
}

@keyframes tour-menu-appear {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

.tour-launcher-menu-v2 .tour-launcher-menu-header {
  padding: 20px;
  background: linear-gradient(135deg, #0891b2, #06b6d4);
  color: white;
}

.tour-launcher-menu-v2 .tour-launcher-menu-header h3 {
  margin: 0 0 4px;
  font-size: 18px;
  font-weight: 600;
}

.tour-launcher-menu-v2 .tour-launcher-menu-header p {
  margin: 0;
  font-size: 13px;
  opacity: 0.9;
}

.tour-launcher-menu-v2 .tour-launcher-menu-item {
  display: flex;
  align-items: center;
  gap: 12px;
  width: 100%;
  padding: 14px 20px;
  border: none;
  background: transparent;
  color: var(--tour-text);
  cursor: pointer;
  transition: background 0.15s ease;
  text-align: left;
}

.tour-launcher-menu-v2 .tour-launcher-menu-item:hover {
  background: var(--tour-bg-secondary);
}

.tour-launcher-menu-v2 .tour-launcher-menu-item.tour-launcher-menu-main {
  background: rgba(6, 182, 212, 0.1);
  border-bottom: 1px solid var(--tour-border);
}

.tour-launcher-menu-v2 .tour-launcher-menu-item.completed {
  opacity: 0.6;
}

.tour-launcher-menu-v2 .tour-launcher-menu-icon {
  font-size: 20px;
  width: 28px;
  text-align: center;
  flex-shrink: 0;
}

.tour-launcher-menu-v2 .tour-launcher-menu-content {
  flex: 1;
  min-width: 0;
}

.tour-launcher-menu-v2 .tour-launcher-menu-title {
  display: block;
  font-size: 14px;
  font-weight: 500;
}

.tour-launcher-menu-v2 .tour-launcher-menu-subtitle {
  display: block;
  font-size: 12px;
  color: var(--tour-text-secondary);
  margin-top: 2px;
}

.tour-launcher-menu-v2 .tour-launcher-section-progress {
  font-size: 12px;
  color: var(--tour-accent);
  font-weight: 500;
}

.tour-launcher-menu-v2 .tour-launcher-menu-divider {
  padding: 8px 20px;
  font-size: 11px;
  color: var(--tour-text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border-top: 1px solid var(--tour-border);
  margin-top: 8px;
}

.tour-launcher-menu-v2 .tour-launcher-sections {
  max-height: 240px;
  overflow-y: auto;
}

.tour-launcher-menu-v2 .tour-launcher-menu-footer {
  padding: 12px 20px;
  border-top: 1px solid var(--tour-border);
  display: flex;
  justify-content: center;
}

.tour-launcher-menu-v2 .tour-launcher-menu-reset {
  font-size: 12px;
  color: var(--tour-text-secondary);
  background: none;
  border: none;
  cursor: pointer;
  padding: 6px 12px;
  border-radius: 6px;
  transition: all 0.15s ease;
}

.tour-launcher-menu-v2 .tour-launcher-menu-reset:hover {
  color: #ef4444;
  background: rgba(239, 68, 68, 0.1);
}